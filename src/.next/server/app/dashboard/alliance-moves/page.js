(()=>{var e={};e.id=7227,e.ids=[7227],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},12149:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>i});var a=r(7),n=r(8533),s=r(29377),o=r.n(s),l=r(29799),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);r.d(t,c);let i=["",{children:["dashboard",{children:["alliance-moves",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,27353)),"/Users/ciaranobrien/player-tracker/src/app/dashboard/alliance-moves/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,65697)),"/Users/ciaranobrien/player-tracker/src/app/dashboard/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,97418))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,59224)),"/Users/ciaranobrien/player-tracker/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,73472,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,97418))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/ciaranobrien/player-tracker/src/app/dashboard/alliance-moves/page.tsx"],m="/dashboard/alliance-moves/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/dashboard/alliance-moves/page",pathname:"/dashboard/alliance-moves",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},79601:(e,t,r)=>{Promise.resolve().then(r.bind(r,99788))},91534:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(36834).Z)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},99788:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(54714),n=r(77580),s=r(88934),o=r(91534),l=r(36834);let c=(0,l.Z)("user-minus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),i=(0,l.Z)("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);var d=r(53157),m=r(41784),u=r(80620),x=r(7315),h=r(45823),p=r(1009);(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/components/ui/button'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module '@/components/ui/badge'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module '@/components/ui/export-button'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module '@/lib/export'");throw e.code="MODULE_NOT_FOUND",e}();let N=[{value:"7",label:"Last 7 days"},{value:"14",label:"Last 2 weeks"},{value:"30",label:"Last 30 days"},{value:"60",label:"Last 2 months"},{value:"90",label:"Last 3 months"}],j=[{value:"detectedAt",label:"Date"},{value:"playerName",label:"Player Name"},{value:"currentPower",label:"Power"},{value:"cityLevel",label:"City Level"}];function f(){let e=(0,s.useRouter)(),[t,r]=(0,n.useState)(null),[l,f]=(0,n.useState)(!0),[g,v]=(0,n.useState)("30"),[O,b]=(0,n.useState)("all"),[y,w]=(0,n.useState)("detectedAt"),[_,D]=(0,n.useState)("desc"),[E,U]=(0,n.useState)(1);(0,n.useEffect)(()=>{M()},[g,O,y,_,E]);let M=async()=>{f(!0);try{let e=new URLSearchParams({timeRange:g,alliance:O,sortBy:y,order:_,page:E.toString(),limit:"25"}),t=await fetch(`/api/alliance-moves?${e}`);if(t.ok){let e=await t.json();r(e)}}catch(e){console.error("Error fetching alliance moves:",e)}finally{f(!1)}},L=t=>{e.push(`/dashboard/player/${t.playerId}`)},C=e=>new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),T=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toLocaleString(),F=e=>{switch(e){case"joined":return a.jsx(o.Z,{className:"w-4 h-4 text-green-400"});case"left":return a.jsx(c,{className:"w-4 h-4 text-red-400"});case"transferred":return a.jsx(i,{className:"w-4 h-4 text-blue-400"});default:return a.jsx(d.Z,{className:"w-4 h-4 text-gray-400"})}},P=e=>{switch(e){case"joined":return"bg-green-500/20 text-green-300 border-green-500/30";case"left":return"bg-red-500/20 text-red-300 border-red-500/30";case"transferred":return"bg-blue-500/20 text-blue-300 border-blue-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}};return(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center gap-3",children:[a.jsx(d.Z,{className:"w-8 h-8 text-blue-400"}),"Alliance Moves"]}),a.jsx("p",{className:"text-gray-400",children:"Track player movements between alliances and analyze migration patterns"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[t&&t.moves.length>0&&a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/export-button'");throw e.code="MODULE_NOT_FOUND",e}()),{data:t.moves.map(e=>({playerName:e.playerName,fromAlliance:e.oldAlliance||"No Alliance",toAlliance:e.newAlliance||"No Alliance",power:e.currentPower,killPoints:0,timestamp:e.detectedAt})),exportConfig:Object(function(){var e=Error("Cannot find module '@/lib/export'");throw e.code="MODULE_NOT_FOUND",e}()).allianceMoves,filename:`alliance_moves_${new Date().toISOString().split("T")[0]}`,title:"Kingdom 671 - Alliance Moves",subtitle:`${t.moves.length} alliance moves tracked | Export generated on ${new Date().toLocaleDateString()}`,variant:"outline",size:"sm"}),(0,a.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/button'");throw e.code="MODULE_NOT_FOUND",e}()),{variant:"outline",size:"sm",onClick:()=>{M()},disabled:l,className:"flex items-center gap-2",children:[a.jsx(m.Z,{className:`w-4 h-4 ${l?"animate-spin":""}`}),"Refresh"]})]})]})}),t?.summary&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"Total Moves"}),a.jsx("p",{className:"text-2xl font-bold text-white",children:t.summary.totalMoves}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Last ",t.summary.timeRange.days," days"]})]}),a.jsx(d.Z,{className:"w-8 h-8 text-blue-500"})]})})}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"New Joins"}),a.jsx("p",{className:"text-2xl font-bold text-green-400",children:t.summary.joins}),a.jsx("p",{className:"text-xs text-gray-500",children:"Players joined alliances"})]}),a.jsx(o.Z,{className:"w-8 h-8 text-green-500"})]})})}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"Departures"}),a.jsx("p",{className:"text-2xl font-bold text-red-400",children:t.summary.leaves}),a.jsx("p",{className:"text-xs text-gray-500",children:"Players left alliances"})]}),a.jsx(c,{className:"w-8 h-8 text-red-500"})]})})}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"Transfers"}),a.jsx("p",{className:"text-2xl font-bold text-blue-400",children:t.summary.transfers}),a.jsx("p",{className:"text-xs text-gray-500",children:"Alliance to alliance"})]}),a.jsx(i,{className:"w-8 h-8 text-blue-500"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:[a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"text-white text-sm",children:"Time Range"})}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:a.jsx("select",{value:g,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white text-sm",children:N.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})})]}),(0,a.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:[a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"text-white text-sm",children:"Alliance Filter"})}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:(0,a.jsxs)("select",{value:O,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white text-sm",children:[a.jsx("option",{value:"all",children:"All Alliances"}),t?.filters.alliances.map(e=>a.jsx("option",{value:e,children:e},e))]})})]}),(0,a.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:[a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"text-white text-sm",children:"Sort By"})}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:a.jsx("select",{value:y,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white text-sm",children:j.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})})]}),(0,a.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:[a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"text-white text-sm",children:"Order"})}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:(0,a.jsxs)("select",{value:_,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white text-sm",children:[a.jsx("option",{value:"desc",children:"Newest First"}),a.jsx("option",{value:"asc",children:"Oldest First"})]})})]})]}),t?.summary.mostActiveAlliances&&t.summary.mostActiveAlliances.length>0&&(0,a.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:[a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:(0,a.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"text-white flex items-center gap-2",children:[a.jsx(u.Z,{className:"w-5 h-5"}),"Most Active Alliances (New Joins)"]})}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:t.summary.mostActiveAlliances.map((e,t)=>(0,a.jsxs)("div",{className:"text-center p-4 bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-600 rounded-full text-sm font-bold mx-auto mb-2",children:(t+1).toString()}),a.jsx("p",{className:"text-white font-medium",children:e.alliance}),(0,a.jsxs)("p",{className:"text-blue-400 text-sm",children:[e.joinCount," joins"]})]},e.alliance))})})]}),(0,a.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"bg-gray-800 border-gray-700",children:[a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:(0,a.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"text-white flex items-center justify-between",children:[a.jsx("span",{children:"Recent Alliance Moves"}),t&&(0,a.jsxs)("span",{className:"text-sm text-gray-400 font-normal",children:[t.pagination.totalMoves," total moves"]})]})}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/card'");throw e.code="MODULE_NOT_FOUND",e}()),{children:l?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500"})}):t&&t.moves.length>0?a.jsx("div",{className:"space-y-3",children:t.moves.map(e=>(0,a.jsxs)("div",{onClick:()=>L(e),className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg hover:bg-gray-600 cursor-pointer transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[F(e.moveType),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-white font-medium",children:e.playerName}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[(0,a.jsxs)("span",{children:["Level ",e.cityLevel]}),a.jsx("span",{children:"•"}),(0,a.jsxs)("span",{children:[T(e.currentPower)," Power"]}),a.jsx("span",{children:"•"}),(0,a.jsxs)("span",{children:["ID: ",e.playerId]})]})]})]}),a.jsx("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("span",{className:"text-gray-300",children:e.oldAlliance||"No Alliance"}),a.jsx(x.Z,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-white",children:e.newAlliance||"No Alliance"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/badge'");throw e.code="MODULE_NOT_FOUND",e}()),{className:P(e.moveType),children:e.moveType}),a.jsx("span",{className:"text-xs text-gray-500",children:C(e.detectedAt)})]})]})})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[a.jsx(d.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"No alliance moves found for the selected filters"})]})})]}),t&&t.pagination.totalPages>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:["Page ",t.pagination.currentPage," of ",t.pagination.totalPages," • ",t.pagination.totalMoves," total moves"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/button'");throw e.code="MODULE_NOT_FOUND",e}()),{variant:"outline",size:"sm",onClick:()=>U(Math.max(1,E-1)),disabled:1===E,children:a.jsx(h.Z,{className:"w-4 h-4"})}),a.jsx("span",{className:"px-3 py-1 bg-gray-700 rounded text-sm text-white",children:E}),a.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/button'");throw e.code="MODULE_NOT_FOUND",e}()),{variant:"outline",size:"sm",onClick:()=>U(Math.min(t.pagination.totalPages,E+1)),disabled:E===t.pagination.totalPages,children:a.jsx(p.Z,{className:"w-4 h-4"})})]})]})]})}},27353:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>s,__esModule:()=>n,default:()=>o});let a=(0,r(71481).createProxy)(String.raw`/Users/ciaranobrien/player-tracker/src/app/dashboard/alliance-moves/page.tsx`),{__esModule:n,$$typeof:s}=a,o=a.default}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[3499,2463,9898,4378,2813,1574],()=>r(12149));module.exports=a})();